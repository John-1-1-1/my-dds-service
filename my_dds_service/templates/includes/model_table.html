{% load custom_filters %}

<h2 class="mt-4">
    {{ data.title }}
    <small><a href="#"
              class="btn btn-sm btn-success"
              data-bs-toggle="modal"
              data-bs-target="#editModal"
              data-object-name="{{ data.create_form_name|escape }}"
              data-edit-url="{% url data.create_url %}"
              data-is-create="true">
        Добавить
    </a></small>
</h2>
<table class="table table-striped table-bordered">
    <thead class="thead-dark">
    <tr>
        {% for header in data.headers %}
        <th>{{ header }}</th>
        {% endfor %}
        <th style="width: 100px;">Действия</th>
    </tr>
    </thead>
    <tbody>
    {% for item in data.object_list %}
    <tr>
        {% for field_name in data.display_fields %}
        <td>
            {% with field_value=item|getattribute:field_name %}
            {{ field_value }}
            {% endwith %}
        </td>
        {% endfor %}

        <td>
            <div class="dropdown">
                <button class="btn btn-sm btn-secondary dropdown-toggle"
                        type="button"
                        id="actionsDropdown{{ item.pk }}"
                        data-bs-toggle="dropdown">
                    Действия
                </button>

                <ul class="dropdown-menu" aria-labelledby="actionsDropdown{{ item.pk }}">
                    <li>
                        <a class="dropdown-item edit-link"
                           href="#"
                           data-bs-toggle="modal"
                           data-bs-target="#editModal"
                           data-object-name="{{ data.create_form_name|escape }}"
                           data-edit-url="{% url data.update_url_name item.pk %}" >
                            <i class="fas fa-edit"></i> Редактировать
                        </a>
                    </li>
                    <li>
                        <a class="dropdown-item text-danger"
                           href="#"
                           data-bs-toggle="modal"
                           data-bs-target="#deleteConfirmModal"
                           data-object-name="{{ item }}"
                           data-object-id="{{ item.pk }}"
                           data-delete-url-name="{% url data.delete_url_name item.pk %}">
                            <i class="fas fa-trash-alt"></i> Удалить
                        </a>
                    </li>
                </ul>
            </div>
        </td>

    </tr>
    {% empty %}
    <tr>
        <td colspan="{{ data.headers|length|add:1 }}" class="text-center">Нет объектов.</td>
    </tr>
    {% endfor %}
    </tbody>
</table>